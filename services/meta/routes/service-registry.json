{
  "generated_at": "2026-02-04T16:22:30.185Z",
  "generator_version": "3.1.0",
  "total_services": 2,
  "services": [
    {
      "name": "automated-annotation",
      "description": "Automated annotation service using agent architecture for classification tasks. Supports vector-based model classification and LLM-based property classification via orchestration handlers.",
      "base_path": "/automations/annotation",
      "endpoints": [
        {
          "path": "/{category}/classify/model",
          "method": "POST",
          "description": "Classify model using vector-based similarity search via model_vector_classifier_api_handler. Uses pre-computed image vectors from image-processing table, queries Pinecone for similar images, and performs majority voting. Returns model, model_id, root_model, root_model_id, and confidence.",
          "parameters": {
            "path": {
              "category": "string (required) - Category (e.g., 'bags')"
            },
            "body": {
              "image": "string (required) - Processing/Image ID (processing_id) stored in the image-processing DynamoDB table. Signed image URL will be looked up automatically.",
              "processing_id": "string (optional) - Alternative to 'image' field",
              "brand": "string (required) - Brand namespace for Pinecone (e.g., 'jacquemus'). Uses 7 nearest neighbors by default",
              "category": "string (optional) - Category for root lookup (default: 'bags')"
            }
          }
        },
        {
          "path": "/{category}/classify/{property}",
          "method": "POST",
          "description": "Classify a property (type, material, colour, etc.) using the new agent architecture system via agent_orchestration_api_handler. Maps category/property to config_id, calls orchestration function, and returns formatted result with IDs and names.",
          "parameters": {
            "path": {
              "category": "string (required) - Category (e.g., 'bags')",
              "property": "string (required) - Property to classify (e.g., 'material', 'colour', 'type', 'condition')"
            },
            "body": {
              "image": "string (optional) - Processing/Image ID. Signed image URL will be looked up automatically from annotation-data-service-layer.",
              "image_url": "string (optional) - Direct image URL (if already signed, takes precedence over image)",
              "text_input": "string (optional) - Pre-formatted text string (takes precedence if provided)",
              "text_metadata": "object (optional) - Text metadata as JSON dict (e.g., {\"brand\": \"...\", \"title\": \"...\", \"description\": \"...\"}). Allows column filtering before passing to agent.",
              "text_dump": "string (optional) - Legacy field - treated as text_input if provided (for backward compatibility)",
              "brand": "string (optional) - Brand name (used to build text_metadata dict if text_metadata not provided)",
              "title": "string (optional) - Title (used to build text_metadata dict if text_metadata not provided)",
              "description": "string (optional) - Description (used to build text_metadata dict if text_metadata not provided)",
              "input_mode": "string (optional) - Input mode: 'auto', 'image-only', 'text-only', 'multimodal' (default: 'auto')"
            }
          }
        },
        {
          "path": "/automations/agents",
          "method": "POST",
          "description": "Direct agent execution endpoint (INTERNAL USE ONLY - called by external orchestration scripts). ARCHITECTURE EXCEPTION: Directly calls agent_architecture (violates normal pattern). DEPRECATED: Will be removed once legacy systems are migrated. New code should use orchestration functions via agent_orchestration_api_handler.",
          "parameters": {
            "body": {
              "config_id": "string (required) - Agent configuration ID from DynamoDB (e.g., 'material-30', 'classifier-material-bags')",
              "input_data": "object (required) - Task-specific input data: {item_id: string (required), image_url: string (optional), text_input: string (optional), input_mode: string (optional, default: 'auto')}"
            }
          }
        },
        {
          "path": "/health",
          "method": "GET",
          "description": "Health check endpoint for the automated annotation service. Returns service status and stage information.",
          "parameters": {}
        },
        {
          "path": "/csv-config",
          "method": "POST",
          "description": "Generate CSV column mapping configuration using LLM analysis. Analyzes sample rows from a CSV file and produces a mapping that identifies brand, title, description, and image columns. Configs are cached in DynamoDB for reuse.",
          "parameters": {
            "body": {
              "CSV_uuid": "string (required) - Unique identifier for the CSV file",
              "sample_rows": "array (required) - List of 5-10 sample row dicts from the CSV",
              "organisation_uuid": "string (optional) - Organization scope for config lookup/storage",
              "max_chars": "integer (optional) - Maximum characters for sample data (default: 25000)"
            }
          }
        }
      ]
    },
    {
      "name": "image-service",
      "description": "Image service for managing image uploads, processing status, and processed image URLs",
      "base_path": "/images",
      "endpoints": [
        {
          "path": "/upload-url",
          "method": "POST",
          "description": "Generate a presigned URL for uploading images",
          "parameters": {
            "body": {
              "filename": "string (required) - Original filename of the image",
              "contentType": "string (optional) - MIME type of the image",
              "expiresIn": "number (optional) - URL expiration time in seconds (default: 3600)"
            }
          }
        },
        {
          "path": "/upload-url",
          "method": "GET",
          "description": "Generate a presigned URL for uploading images (query params)",
          "parameters": {
            "query": {
              "filename": "string (required) - Original filename of the image",
              "contentType": "string (optional) - MIME type of the image",
              "expiresIn": "number (optional) - URL expiration time in seconds (default: 3600)"
            }
          }
        },
        {
          "path": "/status/{processingId}",
          "method": "GET",
          "description": "Get processing status for an image",
          "parameters": {
            "path": {
              "processingId": "string (required) - Processing ID returned from upload"
            }
          }
        },
        {
          "path": "/list",
          "method": "GET",
          "description": "List images with optional filtering",
          "parameters": {
            "query": {
              "status": "string (optional) - Filter by processing status (uploaded, processing, completed, failed)",
              "limit": "number (optional) - Maximum number of results (default: 50)",
              "lastKey": "string (optional) - Pagination token for next page"
            }
          }
        },
        {
          "path": "/processed/{uniqueId}",
          "method": "GET",
          "description": "Get processed image URLs for a specific upload",
          "parameters": {
            "path": {
              "uniqueId": "string (required) - Unique ID returned from upload"
            }
          }
        },
        {
          "path": "/process/{uniqueId}",
          "method": "POST",
          "description": "Manually trigger processing for an uploaded image",
          "parameters": {
            "path": {
              "uniqueId": "string (required) - Unique ID returned from upload"
            }
          }
        },
        {
          "path": "/image/{uniqueId}",
          "method": "DELETE",
          "description": "Delete an image and all its processed versions",
          "parameters": {
            "path": {
              "uniqueId": "string (required) - Unique ID returned from upload"
            }
          }
        },
        {
          "path": "/health",
          "method": "GET",
          "description": "Health check endpoint for the image service",
          "parameters": {}
        }
      ]
    }
  ],
  "summary": {
    "total_endpoints": 13
  }
}